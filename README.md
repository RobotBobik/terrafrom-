Щоб не хардкодити AMI, достатньо завести змінні для назви ОС (наприклад “ubuntu” чи “amzn2”), її версії (скажімо “jammy-22.04” або просто “2”), архітектури (“amd64” чи “x86_64”), типу віртуалізації (“hvm”) і типу кореневого диска (“ebs”). Потім у локалі збираєте рядок-шаблон імені (наприклад для Ubuntu це “ubuntu/images/hvm-ssd/ubuntu-jammy-22.04-amd64-server-*”), а в блоці data “aws_ami” ставите most_recent = true, фільтри name = цей шаблон, virtualization-type і root-device-type, а owners берете з мапи, де для “ubuntu” стоїть ID Canonical, для “amzn2” – Amazon і т. д. Після цього в ресурсі aws_instance ставите ami = data.aws_ami.іd і отримуєте завжди найсвіжіший образ без жодного хардкоду.
